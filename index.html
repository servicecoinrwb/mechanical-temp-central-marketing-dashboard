<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mechanical Temp - Marketing Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }
        .dashboard-card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            border: 1px solid #e5e7eb;
        }
        .dashboard-header {
            background-color: #1A2D4E;
            color: white;
        }
        .status-live, .status-select {
            padding: 2px 10px;
            border-radius: 9999px;
            font-size: 0.8rem;
            font-weight: 600;
            text-align: center;
        }
        .status-live { background-color: #dcfce7; color: #166534; }
        .status-draft { background-color: #fef9c3; color: #854d0e; }
        
        .status-select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            border: none;
            background-color: transparent;
            cursor: pointer;
        }
        .status-select.status-active { background-color: #dcfce7; color: #166534; }
        .status-select.status-paused { background-color: #fee2e2; color: #991b1b; }

        .task-item:has(input:checked) label, .task-item:has(input:checked) a {
            text-decoration: line-through;
            color: #6b7280;
        }
        th {
            background-color: #f9fafb;
        }
        /* AI Chat Styles */
        .chat-history { height: 300px; overflow-y: auto; }
        .user-msg { background-color: #e0f2fe; text-align: right; }
        .ai-msg { background-color: #f3f4f6; }
        .loading-dots div { animation: blink 1.4s infinite both; }
        .loading-dots div:nth-child(2) { animation-delay: 0.2s; }
        .loading-dots div:nth-child(3) { animation-delay: 0.4s; }
        @keyframes blink { 0%, 80%, 100% { opacity: 0; } 40% { opacity: 1; } }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="dashboard-header p-6 rounded-t-lg flex flex-col md:flex-row justify-between items-center">
            <div>
                <h1 class="text-3xl font-bold">Mechanical Temp</h1>
                <p class="text-lg text-gray-300">Central Marketing Dashboard</p>
            </div>
            <div class="flex flex-wrap justify-center gap-2 mt-4 md:mt-0">
                <a href="https://piccolo-spinach-k6p6.squarespace.com/config/" target="_blank" class="bg-white/10 hover:bg-white/20 text-white font-semibold py-2 px-4 rounded-lg transition">Website Admin</a>
                <a href="https://search.google.com/search-console?resource_id=sc-domain%3Amechanicaltemp.com" target="_blank" class="bg-white/10 hover:bg-white/20 text-white font-semibold py-2 px-4 rounded-lg transition">Search Console</a>
                <a href="https://www.google.com/search?q=mechanical+temp" target="_blank" class="bg-white/10 hover:bg-white/20 text-white font-semibold py-2 px-4 rounded-lg transition">Business Profile</a>
                <a href="https://ads.google.com/aw/campaigns" target="_blank" class="bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg transition">Google Ads</a>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mt-8">
            <div class="lg:col-span-2 space-y-8">
                <div class="dashboard-card">
                    <div class="p-6">
                        <h2 class="text-2xl font-bold mb-4">Pillar 1: On-Page SEO (Organic)</h2>
                        <h3 class="text-xl font-semibold mb-2">A. Local Service Area Pages</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left border-collapse">
                                <thead>
                                    <tr><th class="p-3 border-b">City</th><th class="p-3 border-b">URL</th><th class="p-3 border-b">Status</th></tr>
                                </thead>
                                <tbody id="service-pages-table-body">
                                    <!-- Cities will be loaded here by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-4 flex space-x-2">
                            <input type="text" id="new-city-name" placeholder="Enter new city name..." class="flex-grow p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none">
                            <button id="add-city-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg">Add City</button>
                        </div>

                        <h3 class="text-xl font-semibold mt-6 mb-2"><a href="https://piccolo-spinach-k6p6.squarespace.com/config/pages/64bafe92999de952790fe6fb" target="_blank" class="text-blue-600 hover:underline">B. Content Strategy: Blog / Resource Center</a></h3>
                        <div class="space-y-2" id="blog-post-list">
                             <!-- Blog posts will be loaded here by JavaScript -->
                        </div>
                         <div class="mt-4 flex space-x-2">
                            <input type="text" id="new-blog-post" placeholder="Enter new blog post title..." class="flex-grow p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none">
                            <button id="add-blog-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg">Add Post</button>
                        </div>
                    </div>
                </div>
                <div class="dashboard-card">
                    <div class="p-6">
                        <h2 class="text-2xl font-bold mb-4">Pillar 5: Google Ads (Paid Search)</h2>
                         <h3 class="text-xl font-semibold mb-2">A. Campaign Foundation</h3>
                        <div class="space-y-2">
                             <div class="task-item flex items-center"><input type="checkbox" id="task-foundation-1" class="h-4 w-4 rounded task-checkbox"><label for="task-foundation-1" class="ml-3 text-gray-700">High-Converting Landing Page Live (<a href="https://www.mechanicaltemp.site" target="_blank" class="text-blue-600 hover:underline">mechanicaltemp.site</a>)</label></div>
                             <div class="task-item flex items-center"><input type="checkbox" id="task-foundation-2" class="h-4 w-4 rounded task-checkbox"><label for="task-foundation-2" class="ml-3 text-gray-700">Conversion Tracking Installed (Calls & Forms)</label></div>
                             <div class="task-item flex items-center"><input type="checkbox" id="task-foundation-3" class="h-4 w-4 rounded task-checkbox"><label for="task-foundation-3" class="ml-3 text-gray-700">LSA Campaign Paused to focus budget</label></div>
                        </div>
                         <h3 class="text-xl font-semibold mt-6 mb-2">B. Active Campaign Management (Weekly Tasks)</h3>
                        <div class="space-y-2">
                             <div class="task-item flex items-center"><input id="task-weekly-1" type="checkbox" class="h-4 w-4 rounded task-checkbox"><label for="task-weekly-1" class="ml-3 text-gray-700">Review "Search Terms" Report for wasted spend</label></div>
                             <div class="task-item flex items-center"><input id="task-weekly-2" type="checkbox" class="h-4 w-4 rounded task-checkbox"><label for="task-weekly-2" class="ml-3 text-gray-700">Add new Negative Keywords from report</label></div>
                             <div class="task-item flex items-center"><input id="task-weekly-3" type="checkbox" class="h-4 w-4 rounded task-checkbox"><label for="task-weekly-3" class="ml-3 text-gray-700">Check Ad Performance (Click-Through Rate)</label></div>
                        </div>
                         <h3 class="text-xl font-semibold mt-6 mb-2">C. Seasonal Ad Group Status</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left border-collapse" id="ad-groups-table">
                                <thead>
                                    <tr><th class="p-3 border-b">Ad Group</th><th class="p-3 border-b">Recommended Season</th><th class="p-3 border-b">Status</th></tr>
                                </thead>
                                <tbody>
                                    <tr class="hover:bg-gray-50">
                                        <td class="p-3 border-b">Furnace Maintenance</td>
                                        <td class="p-3 border-b">Fall / Winter</td>
                                        <td class="p-3 border-b"><select class="status-select"><option value="active">✅ Active</option><option value="paused">❌ Paused</option></select></td>
                                    </tr>
                                    <tr class="hover:bg-gray-50">
                                        <td class="p-3 border-b">Emergency Furnace Repair</td>
                                        <td class="p-3 border-b">Fall / Winter</td>
                                        <td class="p-3 border-b"><select class="status-select"><option value="active">✅ Active</option><option value="paused">❌ Paused</option></select></td>
                                    </tr>
                                     <tr class="hover:bg-gray-50">
                                        <td class="p-3 border-b">New Furnace Installation</td>
                                        <td class="p-3 border-b">Fall / Winter</td>
                                        <td class="p-3 border-b"><select class="status-select"><option value="active">✅ Active</option><option value="paused">❌ Paused</option></select></td>
                                    </tr>
                                    <tr class="hover:bg-gray-50">
                                        <td class="p-3 border-b">Emergency AC Repair</td>
                                        <td class="p-3 border-b">Spring / Summer</td>
                                        <td class="p-3 border-b"><select class="status-select"><option value="active">✅ Active</option><option value="paused">❌ Paused</option></select></td>
                                    </tr>
                                    <tr class="hover:bg-gray-50">
                                        <td class="p-3 border-b">AC Tune-Up</td>
                                        <td class="p-3 border-b">Spring</td>
                                        <td class="p-3 border-b"><select class="status-select"><option value="active">✅ Active</option><option value="paused">❌ Paused</option></select></td>
                                    </tr>
                                    <tr class="hover:bg-gray-50">
                                        <td class="p-3 border-b">New AC Installation</td>
                                        <td class="p-3 border-b">Spring / Summer</td>
                                        <td class="p-3 border-b"><select class="status-select"><option value="active">✅ Active</option><option value="paused">❌ Paused</option></select></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="space-y-8">
                <div class="dashboard-card">
                    <div class="p-6">
                        <h2 class="text-2xl font-bold mb-4">Pillar 6: AI Marketing Assistant</h2>
                        <div class="chat-history p-4 bg-gray-100 rounded-lg border" id="chat-history">
                           <div class="ai-msg p-3 rounded-lg mb-2">
                                <p class="font-semibold text-gray-800">Hello!</p>
                                <p class="text-gray-700">How can I help you with your marketing today? Ask me to write ad copy, suggest blog topics, or draft a social media post.</p>
                           </div>
                        </div>
                        <div class="mt-4 flex space-x-2">
                            <input type="text" id="chat-input" placeholder="Ask for a blog post idea..." class="flex-grow p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none">
                            <button id="send-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg">Send</button>
                        </div>
                    </div>
                </div>

                <div class="dashboard-card">
                       <div class="p-6">
                            <h2 class="text-2xl font-bold mb-4">Pillar 2: Off-Page SEO (Local)</h2>
                            <h3 class="text-xl font-semibold mb-2">A. Google Business Profile (Weekly)</h3>
                            <div class="space-y-2">
                                <div class="task-item flex items-center"><input id="task-gbp-1" type="checkbox" class="h-4 w-4 rounded task-checkbox"><label for="task-gbp-1" class="ml-3 text-gray-700">Publish "Update" Post</label></div>
                                <div class="task-item flex items-center"><input id="task-gbp-2" type="checkbox" class="h-4 w-4 rounded task-checkbox"><label for="task-gbp-2" class="ml-3 text-gray-700">Add New Job Photos</label></div>
                                <div class="task-item flex items-center"><input id="task-gbp-3" type="checkbox" class="h-4 w-4 rounded task-checkbox"><label for="task-gbp-3" class="ml-3 text-gray-700">Respond to All New Reviews</label></div>
                            </div>
                       </div>
                </div>
                <div class="dashboard-card">
                       <div class="p-6">
                            <h2 class="text-2xl font-bold mb-4">Pillar 3: Technical SEO</h2>
                            <h3 class="text-xl font-semibold mb-2">A. Monthly Health Check</h3>
                            <div class="space-y-2">
                                <div class="task-item flex items-center"><input id="task-tech-1" type="checkbox" class="h-4 w-4 rounded task-checkbox"><label class="ml-3 text-gray-700"><a href="https://pagespeed.web.dev/" target="_blank" class="hover:underline text-blue-600">Run PageSpeed Insights report</a></label></div>
                                <div class="task-item flex items-center"><input id="task-tech-2" type="checkbox" class="h-4 w-4 rounded task-checkbox"><label for="task-tech-2" class="ml-3 text-gray-700">Check for crawl errors (in GSC)</label></div>
                            </div>
                            <h3 class="text-xl font-semibold mt-6 mb-2">B. How-To Guides & Summaries</h3>
                            <div class="text-sm text-gray-600">
                               <p><strong>How to Check for Crawl Errors:</strong><br> 1. Go to Google Search Console (GSC). <br>2. In the left menu, click 'Indexing' > 'Pages'. <br>3. Scroll down to the "Why pages aren't indexed" section. <br>4. Look for "Not found (404)" errors. If important pages are listed, set up a redirect in Squarespace.</p>
                            </div>
                       </div>
                </div>
                <div class="dashboard-card">
                       <div class="p-6">
                            <h2 class="text-2xl font-bold mb-4">Pillar 4: Social & Email</h2>
                            <h3 class="text-xl font-semibold mb-2">A. Social Media (Weekly)</h3>
                            <div class="space-y-2">
                                <div class="task-item flex items-center"><input id="task-social-1" type="checkbox" class="h-4 w-4 rounded task-checkbox"><label class="ml-3 text-gray-700"><a href="https://www.facebook.com/mechanicaltemp" target="_blank" class="hover:underline text-blue-600">Post on Facebook (2x)</a></label></div>
                            </div>
                            <h3 class="text-xl font-semibold mt-6 mb-2">B. Email Marketing (Monthly)</h3>
                            <div class="space-y-2">
                                <div class="task-item flex items-center"><input id="task-email-1" type="checkbox" class="h-4 w-4 rounded task-checkbox"><label for="task-email-1" class="ml-3 text-gray-700">Send newsletter with tips & offers</label></div>
                            </div>
                       </div>
                </div>
                 <div class="dashboard-card">
                       <div class="p-6">
                            <h2 class="text-2xl font-bold mb-4">🎯 Q4 2025 Goals</h2>
                            <ul class="list-disc list-inside space-y-2 text-gray-700">
                               <li>Publish 2 new blog posts.</li>
                               <li>Generate 15 qualified leads from Google Ads.</li>
                               <li>Achieve a Cost Per Lead of under $75.</li>
                               <li>Generate 10 new 5-star reviews on Google.</li>
                            </ul>
                       </div>
                </div>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- DATA PERSISTENCE USING LOCALSTORAGE ---

        const saveState = () => {
            // 1. Save Service Pages
            const servicePages = [];
            document.querySelectorAll('#service-pages-table-body tr').forEach(row => {
                const city = row.cells[0].textContent;
                servicePages.push({ city });
            });
            localStorage.setItem('dashboard_servicePages', JSON.stringify(servicePages));

            // 2. Save Blog Posts
            const blogPosts = [];
            document.querySelectorAll('#blog-post-list .task-item').forEach(item => {
                const title = item.querySelector('a').textContent;
                const checked = item.querySelector('input').checked;
                blogPosts.push({ title, checked });
            });
            localStorage.setItem('dashboard_blogPosts', JSON.stringify(blogPosts));

            // 3. Save Checkboxes
            const checkboxStates = {};
            document.querySelectorAll('.task-checkbox').forEach(box => {
                checkboxStates[box.id] = box.checked;
            });
            localStorage.setItem('dashboard_checkboxStates', JSON.stringify(checkboxStates));

            // 4. Save Ad Group Statuses
            const adGroupStatuses = {};
            document.querySelectorAll('#ad-groups-table .status-select').forEach(select => {
                const adGroupName = select.closest('tr').cells[0].textContent;
                adGroupStatuses[adGroupName] = select.value;
            });
            localStorage.setItem('dashboard_adGroupStatuses', JSON.stringify(adGroupStatuses));
             console.log("State saved to localStorage!");
        };

        const loadState = () => {
            // 1. Load Service Pages
            const savedPages = JSON.parse(localStorage.getItem('dashboard_servicePages')) || [
                { city: 'Dearborn' }, { city: 'Southfield' }, { city: 'Novi' },
            ];
            renderServicePages(savedPages);

            // 2. Load Blog Posts
            const savedPosts = JSON.parse(localStorage.getItem('dashboard_blogPosts')) || [
                { title: 'How to Prepare Your Furnace for a Michigan Winter', checked: false },
                { title: "Is My AC Ready for Michigan's Humid Summers?", checked: false },
            ];
            renderBlogPosts(savedPosts);

            // 3. Load Checkboxes
            const savedCheckboxes = JSON.parse(localStorage.getItem('dashboard_checkboxStates')) || {};
            renderCheckboxes(savedCheckboxes);

            // 4. Load Ad Group Statuses
            const savedAdGroups = JSON.parse(localStorage.getItem('dashboard_adGroupStatuses')) || {};
            renderAdGroups(savedAdGroups);
             console.log("State loaded from localStorage!");
        };

        // --- RENDERING FUNCTIONS ---
        const renderServicePages = (pages) => {
            const tableBody = document.getElementById('service-pages-table-body');
            tableBody.innerHTML = '';
            pages.forEach(page => {
                const newRow = document.createElement('tr');
                newRow.classList.add('hover:bg-gray-50');
                const slug = page.city.toLowerCase().replace(/\s+/g, '-');
                const newUrl = `https://www.mechanicaltemp.com/service-areas/${slug}`;
                newRow.innerHTML = `<td class="p-3 border-b">${page.city}</td><td class="p-3 border-b"><a href="${newUrl}" target="_blank" class="text-blue-600 hover:underline">/${slug}</a></td><td class="p-3 border-b"><span class="status-live">✅ Live</span></td>`;
                tableBody.appendChild(newRow);
            });
        };

        const renderBlogPosts = (posts) => {
            const blogList = document.getElementById('blog-post-list');
            blogList.innerHTML = '';
            posts.forEach(post => {
                const newItem = document.createElement('div');
                newItem.classList.add('task-item', 'flex', 'items-center');
                const newId = 'task-blog-' + post.title.replace(/\s+/g, '-').toLowerCase();
                newItem.innerHTML = `<input id="${newId}" type="checkbox" class="h-4 w-4 rounded task-checkbox" ${post.checked ? 'checked' : ''}><label class="ml-3 text-gray-700"><a href="https://piccolo-spinach-k6p6.squarespace.com/config/pages/64bafe92999de952790fe6fb" target="_blank" class="hover:underline text-blue-600">${post.title}</a></label>`;
                blogList.appendChild(newItem);
            });
            // Re-attach listeners after rendering
            document.querySelectorAll('#blog-post-list .task-checkbox').forEach(el => el.addEventListener('change', saveState));
        };

        const renderCheckboxes = (states) => {
            for (const id in states) {
                const checkbox = document.getElementById(id);
                if (checkbox) checkbox.checked = states[id];
            }
        };

        const updateSelectAppearance = (selectElement) => {
            selectElement.classList.remove('status-active', 'status-paused');
            selectElement.classList.add(selectElement.value === 'active' ? 'status-active' : 'status-paused');
        };

        const renderAdGroups = (statuses) => {
            document.querySelectorAll('#ad-groups-table .status-select').forEach(select => {
                const adGroupName = select.closest('tr').cells[0].textContent;
                if (statuses[adGroupName]) {
                    select.value = statuses[adGroupName];
                }
                updateSelectAppearance(select);
            });
        };
        
        // --- EVENT LISTENERS SETUP ---
        function setupEventListeners() {
            document.getElementById('add-city-btn').addEventListener('click', () => {
                const cityNameInput = document.getElementById('new-city-name');
                const cityName = cityNameInput.value.trim();
                if (cityName) {
                    const currentPages = JSON.parse(localStorage.getItem('dashboard_servicePages')) || [];
                    currentPages.push({ city: cityName });
                    renderServicePages(currentPages);
                    cityNameInput.value = '';
                    saveState();
                }
            });

            document.getElementById('add-blog-btn').addEventListener('click', () => {
                const blogPostInput = document.getElementById('new-blog-post');
                const postTitle = blogPostInput.value.trim();
                if (postTitle) {
                    const currentPosts = JSON.parse(localStorage.getItem('dashboard_blogPosts')) || [];
                    currentPosts.push({ title: postTitle, checked: false });
                    renderBlogPosts(currentPosts);
                    blogPostInput.value = '';
                    saveState();
                }
            });

            document.querySelectorAll('.task-checkbox, .status-select').forEach(element => {
                element.addEventListener('change', saveState);
            });
            
             document.querySelectorAll('#ad-groups-table .status-select').forEach(select => {
                select.addEventListener('change', function() {
                    updateSelectAppearance(this);
                });
            });
        }
        
        // --- AI CHAT ---
        const chatHistory = document.getElementById('chat-history');
        const chatInput = document.getElementById('chat-input');
        const sendBtn = document.getElementById('send-btn');
        
        const handleSend = async () => {
            const userPrompt = chatInput.value.trim();
            if (!userPrompt) return;

            const apiKey = ""; // API key is handled by the environment, leave empty.

            const userMsgDiv = document.createElement('div');
            userMsgDiv.className = 'user-msg p-3 rounded-lg mb-2';
            userMsgDiv.innerHTML = `<p class="font-semibold text-sky-800">You</p><p class="text-gray-700">${userPrompt}</p>`;
            chatHistory.appendChild(userMsgDiv);
            chatInput.value = '';
            chatHistory.scrollTop = chatHistory.scrollHeight;

            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'ai-msg p-3 rounded-lg mb-2 flex items-center space-x-2';
            loadingDiv.innerHTML = `<p class="font-semibold text-gray-800">AI Assistant</p><div class="loading-dots flex space-x-1"><div class="w-2 h-2 bg-gray-500 rounded-full"></div><div class="w-2 h-2 bg-gray-500 rounded-full"></div><div class="w-2 h-2 bg-gray-500 rounded-full"></div></div>`;
            chatHistory.appendChild(loadingDiv);
            chatHistory.scrollTop = chatHistory.scrollHeight;
            
            try {
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                const systemPrompt = "You are a world-class marketing assistant for Mechanical Temp, a small HVAC company based in Metro Detroit. Your goal is to provide creative and practical marketing ideas. Be concise, friendly, and focus on strategies that deliver real value. Generate blog post titles, ad copy, social media posts, and other marketing content on request. Format your responses with simple HTML like <p>, <ul>, <li>, and <strong> for readability.";
                const payload = {
                    contents: [{ parts: [{ text: userPrompt }] }],
                    systemInstruction: { parts: [{ text: systemPrompt }] },
                };

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`API error: ${response.statusText}`);

                const result = await response.json();
                const aiText = result.candidates[0].content.parts[0].text;
                loadingDiv.innerHTML = `<p class="font-semibold text-gray-800">AI Assistant</p><div class="text-gray-700">${aiText}</div>`;
            } catch (error) {
                console.error('Error fetching AI response:', error);
                loadingDiv.innerHTML = `<p class="font-semibold text-red-800">Error</p><p class="text-red-700">Sorry, I couldn't get a response. Please check the console for details.</p>`;
            }
            chatHistory.scrollTop = chatHistory.scrollHeight;
        };

        sendBtn.addEventListener('click', handleSend);
        chatInput.addEventListener('keydown', (event) => {
            if (event.key === 'Enter') handleSend();
        });

        // --- START THE APP ---
        loadState();
        setupEventListeners();
    });
    </script>
</body>
</html>

